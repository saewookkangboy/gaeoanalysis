# 사용량 표시 컴포넌트 기능 명세서

## 📋 기본 정보

- **기능명**: 사용량 표시 컴포넌트 (Usage Indicator Component)
- **목적**: Freemium 모델의 사용량을 시각적으로 표시하여 사용자가 현재 사용량과 남은 사용량을 쉽게 파악할 수 있도록 함
- **우선순위**: Medium
- **예상 소요 시간**: 4-6시간
- **작성일**: 2025-12-04
- **작성자**: chunghyo, cursor ai(AI CODE IDE)

---

## 👤 사용자 스토리

### 주요 사용자 스토리
```
As a 서비스 사용자,
I want 현재 사용량과 남은 사용량을 시각적으로 확인하고 싶다,
So that 내가 사용할 수 있는 기능과 한도를 파악하고 필요시 업그레이드할 수 있다.
```

### 추가 사용자 스토리
- **사용자 스토리 2**: 사용량이 한도에 가까워질 때 경고를 받고 싶다
- **사용자 스토리 3**: 업그레이드 버튼을 클릭하여 쉽게 플랜을 업그레이드하고 싶다
- **사용자 스토리 4**: 각 리소스 타입(분석, 챗봇)별로 사용량을 개별적으로 확인하고 싶다

---

## 📝 기능 요구사항

### 기능적 요구사항 (Functional Requirements)

#### FR-1: 사용량 표시
- **설명**: 현재 사용량, 제한, 남은 사용량을 표시
- **우선순위**: High
- **수용 기준**:
  - [ ] 분석 사용량 표시 (사용/제한/남은)
  - [ ] 챗봇 사용량 표시 (사용/제한/남은)
  - [ ] 진행 바(Progress Bar)로 시각화
  - [ ] 퍼센트 표시
  - [ ] 무제한 플랜의 경우 "무제한" 표시

#### FR-2: 경고 표시
- **설명**: 사용량이 한도에 가까워질 때 경고 표시
- **우선순위**: Medium
- **수용 기준**:
  - [ ] 80% 이상 사용 시 경고 색상 (노란색)
  - [ ] 100% 도달 시 경고 색상 (빨간색)
  - [ ] 경고 메시지 표시
  - [ ] 업그레이드 안내 표시

#### FR-3: 업그레이드 버튼
- **설명**: 업그레이드 버튼 제공
- **우선순위**: Medium
- **수용 기준**:
  - [ ] Free 플랜 사용자에게만 표시
  - [ ] 클릭 시 가격 페이지로 이동
  - [ ] 버튼 스타일링 (CTA 스타일)

#### FR-4: 실시간 업데이트
- **설명**: 사용량이 변경될 때 실시간으로 업데이트
- **우선순위**: Low
- **수용 기준**:
  - [ ] 분석 완료 후 사용량 자동 업데이트
  - [ ] 챗봇 사용 후 사용량 자동 업데이트
  - [ ] 폴링 또는 WebSocket (선택적)

### 비기능적 요구사항 (Non-functional Requirements)

#### NFR-1: 성능
- **요구사항**: 컴포넌트 렌더링 < 100ms
- **현재 상태**: 구현 필요

#### NFR-2: 사용성
- **요구사항**: 
  - 직관적인 UI/UX
  - 반응형 디자인
  - 접근성 고려
- **현재 상태**: 구현 필요

#### NFR-3: 일관성
- **요구사항**: 기존 디자인 시스템과 일관성 유지
- **현재 상태**: 구현 필요

---

## 🔌 인터페이스 정의

### 컴포넌트 인터페이스

#### UsageIndicator 컴포넌트
- **컴포넌트명**: `UsageIndicator`
- **위치**: `components/UsageIndicator.tsx`
- **프로퍼티**:
  ```typescript
  interface UsageIndicatorProps {
    usage: {
      analysis: UsageInfo;
      chat: UsageInfo;
    };
    planType: 'free' | 'pro' | 'business';
    showUpgradeButton?: boolean; // 기본값: true
    compact?: boolean; // 기본값: false (컴팩트 모드)
  }
  
  interface UsageInfo {
    resourceType: 'analysis' | 'chat' | 'export';
    used: number;
    limit: number; // -1은 무제한
    remaining: number; // -1은 무제한
    periodStart: string; // ISO 8601
    periodEnd: string; // ISO 8601
  }
  ```

### API 엔드포인트

#### 사용량 조회 (기존)
- **메서드**: GET
- **경로**: `/api/usage`
- **인증**: Required
- **응답**: 기존 Freemium 모델 명세서 참조

---

## ⚠️ 에러 처리

### 예상되는 에러 케이스

#### 에러 1: 사용량 조회 실패
- **발생 조건**: API 호출 실패
- **처리 방법**: 에러 메시지 표시, 재시도 버튼 제공

#### 에러 2: 인증되지 않은 사용자
- **발생 조건**: 로그인하지 않은 사용자
- **처리 방법**: 컴포넌트 숨김 또는 로그인 안내

---

## 🧪 테스트 요구사항

### 단위 테스트
- [ ] 사용량 계산 로직 테스트
- [ ] 경고 표시 로직 테스트
- [ ] 진행 바 계산 테스트

### 통합 테스트
- [ ] API 연동 테스트
- [ ] 사용량 업데이트 테스트

### 수동 테스트 체크리스트
- [ ] Free 플랜 사용량 표시 확인
- [ ] Pro 플랜 사용량 표시 확인 (무제한)
- [ ] 경고 표시 확인 (80%, 100%)
- [ ] 업그레이드 버튼 동작 확인
- [ ] 반응형 디자인 확인

---

## 📚 참고 자료

### 관련 문서
- [Freemium 모델 명세서](../003-freemium-model/spec.md)
- [프로젝트 Constitution](../../memory/constitution.md)

---

## ✅ 명세서 검증 체크리스트

- [x] 모든 사용자 스토리 명세됨
- [x] 모든 기능 요구사항 정의됨
- [x] 모든 에러 케이스 정의됨
- [x] 컴포넌트 인터페이스 명확함
- [x] 테스트 요구사항 정의됨
- [x] 기존 기능과의 호환성 확인됨

---

**명세서 버전**: 1.0  
**최종 업데이트**: 2025-12-04  
**상태**: 명세서 작성 완료, 구현 필요  
**다음 단계**: [Plan 작성](./plan.md)

