# 로그인 전 분석 시작 UX 개선 기능 명세서

## 📋 기본 정보

- **기능명**: 로그인 전 분석 시작 UX 개선
- **목적**: 비로그인 사용자가 분석 시작 버튼을 클릭했을 때, 명확한 안내와 함께 로그인을 유도하여 사용자 경험을 개선
- **우선순위**: High
- **예상 소요 시간**: 4-6시간
- **작성일**: 2025-12-04
- **작성자**: chunghyo, cursor ai(AI CODE IDE)

---

## 👤 사용자 스토리

### 주요 사용자 스토리
```
As a 비로그인 사용자,
I want 분석 시작 버튼을 클릭했을 때 로그인이 필요하다는 것을 명확히 알 수 있고 싶다,
So that 로그인 후 바로 분석을 시작할 수 있다.
```

### 추가 사용자 스토리
- **사용자 스토리 2**: 로그인 완료 후 자동으로 분석 시작 버튼 클릭 이전 단계로 돌아가고 싶다
- **사용자 스토리 3**: 로그인 과정에서 입력한 URL이 유지되기를 원한다

---

## 📝 기능 요구사항

### 기능적 요구사항 (Functional Requirements)

#### FR-1: 로그인 전 분석 시작 버튼 클릭 감지
- **설명**: 분석 시작 버튼 클릭 시 로그인 상태 확인
- **우선순위**: High
- **수용 기준**:
  - [ ] 분석 시작 버튼 클릭 시 로그인 상태 확인
  - [ ] 비로그인 상태일 때 모달 표시
  - [ ] 로그인 상태일 때는 기존 분석 플로우 진행

#### FR-2: 로그인 안내 모달 표시
- **설명**: "소셜 로그인을 진행 후, 분석 시작을 진행합니다" 메시지가 포함된 모달 표시
- **우선순위**: High
- **수용 기준**:
  - [ ] 모달 컴포넌트 생성
  - [ ] 명확한 안내 메시지 표시
  - [ ] 소셜 로그인 버튼 제공 (Google, GitHub)
  - [ ] 취소 버튼 제공
  - [ ] 모달 닫기 기능

#### FR-3: 로그인 페이지로 리디렉션
- **설명**: 모달에서 로그인 버튼 클릭 시 로그인 페이지로 이동하며 분석 의도 전달
- **우선순위**: High
- **수용 기준**:
  - [ ] 로그인 페이지로 리디렉션
  - [ ] URL 파라미터로 분석 의도 전달 (예: `?intent=analyze&url=...`)
  - [ ] 입력한 URL 정보 유지

#### FR-4: 로그인 완료 후 자동 복귀 및 분석 시작
- **설명**: 로그인 완료 후 원래 페이지로 복귀하고 분석 시작
- **우선순위**: High
- **수용 기준**:
  - [ ] 로그인 완료 후 원래 페이지로 복귀
  - [ ] URL 파라미터에서 분석 의도 확인
  - [ ] 입력한 URL이 있으면 자동으로 분석 시작
  - [ ] URL이 없으면 분석 시작 버튼 클릭 이전 단계로 복귀

### 비기능적 요구사항 (Non-functional Requirements)

#### NFR-1: 성능
- **요구사항**: 모달 표시 < 100ms
- **현재 상태**: 구현 필요

#### NFR-2: 사용성
- **요구사항**: 
  - 명확한 안내 메시지
  - 직관적인 UI/UX
  - 반응형 디자인
- **현재 상태**: 구현 필요

#### NFR-3: 일관성
- **요구사항**: 기존 디자인 시스템과 일관성 유지
- **현재 상태**: 구현 필요

### 제약사항 (Constraints)
- 로그인 페이지는 기존 `/login` 경로 사용
- NextAuth.js의 세션 관리 시스템 활용
- URL 파라미터를 통한 상태 전달

---

## 🔌 인터페이스 정의

### 컴포넌트 인터페이스

#### LoginRequiredModal 컴포넌트
- **컴포넌트명**: `LoginRequiredModal`
- **위치**: `components/LoginRequiredModal.tsx`
- **프로퍼티**:
  ```typescript
  interface LoginRequiredModalProps {
    isOpen: boolean;
    onClose: () => void;
    onLogin: (provider: 'google' | 'github') => void;
    url?: string; // 입력한 URL (선택적)
  }
  ```

### URL 파라미터 스키마

#### 로그인 페이지 리디렉션 파라미터
- **파라미터**: `?intent=analyze&url={encodedUrl}`
- **설명**: 
  - `intent`: 분석 의도 표시 (`analyze`)
  - `url`: 입력한 URL (URL 인코딩)

#### 로그인 완료 후 복귀 처리
- **파라미터 확인**: `useSearchParams`로 `intent` 및 `url` 확인
- **자동 분석 시작**: `intent=analyze`이고 `url`이 있으면 자동 분석 시작

---

## ⚠️ 에러 처리

### 예상되는 에러 케이스

#### 에러 1: URL 파라미터 파싱 실패
- **발생 조건**: 잘못된 URL 파라미터 형식
- **처리 방법**: 파라미터 무시하고 일반 페이지 로드

#### 에러 2: 로그인 실패
- **발생 조건**: 소셜 로그인 실패
- **처리 방법**: 에러 메시지 표시, 재시도 옵션 제공

#### 에러 3: 세션 확인 실패
- **발생 조건**: 세션 확인 중 오류
- **처리 방법**: 로그인 페이지로 리디렉션

---

## 🧪 테스트 요구사항

### 단위 테스트
- [ ] 모달 컴포넌트 렌더링 테스트
- [ ] 로그인 상태 확인 로직 테스트
- [ ] URL 파라미터 파싱 테스트

### 통합 테스트
- [ ] 로그인 전 분석 시작 플로우 테스트
- [ ] 로그인 완료 후 자동 복귀 테스트
- [ ] URL 유지 테스트

### 수동 테스트 체크리스트
- [ ] 비로그인 상태에서 분석 시작 버튼 클릭 → 모달 표시 확인
- [ ] 모달에서 로그인 버튼 클릭 → 로그인 페이지 이동 확인
- [ ] 로그인 완료 후 원래 페이지 복귀 확인
- [ ] 입력한 URL 유지 확인
- [ ] 자동 분석 시작 확인
- [ ] 로그인 상태에서 분석 시작 → 기존 플로우 동작 확인

---

## 📚 참고 자료

### 관련 문서
- [프로젝트 README](../README.md)
- [프로젝트 아키텍처](../ARCHITECTURE.md)
- [프로젝트 Constitution](../../memory/constitution.md)

### 기존 기능과의 연관성
- **인증 시스템**: NextAuth.js 세션 관리
- **분석 시스템**: 기존 분석 플로우 유지
- **URL 입력**: UrlInput 컴포넌트

---

## ✅ 명세서 검증 체크리스트

- [x] 모든 사용자 스토리 명세됨
- [x] 모든 기능 요구사항 정의됨
- [x] 모든 에러 케이스 정의됨
- [x] 컴포넌트 인터페이스 명확함
- [x] 테스트 요구사항 정의됨
- [x] 기존 기능과의 호환성 확인됨

---

**명세서 버전**: 1.0  
**최종 업데이트**: 2025-12-04  
**상태**: 명세서 작성 완료, 구현 필요  
**다음 단계**: [Plan 작성](./plan.md)

